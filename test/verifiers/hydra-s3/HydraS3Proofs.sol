// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.17;

import "forge-std/console.sol";
import "src/libs/utils/Structs.sol";
import {AuthBuilder} from "src/libs/utils/AuthBuilder.sol";
import {ClaimBuilder} from "src/libs/utils/ClaimBuilder.sol";
import {ProofBuilder} from "src/libs/utils/SismoConnectProofBuilder.sol";
import {ResponseBuilder} from "test/utils/ResponseBuilderLib.sol";
import {ICommitmentMapperRegistry} from "test/mocks/CommitmentMapperRegistryMock.sol";

contract HydraS3Proofs {
  using ResponseBuilder for SismoConnectResponse;

  // default value for Claim
  bytes16 public constant DEFAULT_CLAIM_GROUP_TIMESTAMP = bytes16("latest");
  uint256 public constant DEFAULT_CLAIM_VALUE = 1;
  bytes16 public constant DEFAULT_CLAIM_GROUP_ID = "";
  ClaimType public constant DEFAULT_CLAIM_TYPE = ClaimType.GTE;
  bytes public constant DEFAULT_CLAIM_EXTRA_DATA = "";

  // default values for Auth
  bool public constant DEFAULT_AUTH_ANON_MODE = false;
  uint256 public constant DEFAULT_AUTH_USER_ID = 0;
  bytes public constant DEFAULT_AUTH_EXTRA_DATA = "";

  // default values for MessageSignature
  bytes public constant DEFAULT_MESSAGE_SIGNATURE_REQUEST = "MESSAGE_SELECTED_BY_USER";

  // default value for appId
  bytes16 public constant DEFAULT_APP_ID = 0x11b1de449c6c4adb0b5775b3868b28b3;
  // default value for namespace
  bytes16 public constant DEFAULT_NAMESPACE = bytes16(keccak256("main"));

  // default value for version
  bytes32 public constant DEFAULT_VERSION = bytes32("sismo-connect-v1.1");

  // default proving scheme
  bytes32 public constant DEFAULT_PROVING_SCHEME = bytes32("hydra-s3.1");

  function getEdDSAPubKey() public pure returns (uint256[2] memory) {
    return [
      0x7f6c5612eb579788478789deccb06cf0eb168e457eea490af754922939ebdb9,
      0x20706798455f90ed993f8dac8075fc1538738a25f0c928da905c0dffd81869fa
    ];
  }

  function getEdDSAPubKeyDevBeta() public pure returns (uint256[2] memory) {
    return [
      0x2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f0256,
      0x30423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db74
    ];
  }

  function getRoot() public pure returns (uint256) {
    return 0x1d4a72bd1c1e4f9ab68c3c4c55afd3e582685a18b9ec09fc96136619d2513fe8;
  }

  // simple sismoConnect with 1 claim
  function getResponseWithOneClaimAndSignature(
    ICommitmentMapperRegistry commitmentMapperRegistry
  ) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    uint256[2] memory devBetaCommitmentMapperPubKey = [
      0x2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f0256,
      0x30423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db74
    ];
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(devBetaCommitmentMapperPubKey);

    return (
      ResponseBuilder
        .empty()
        .withAppId(DEFAULT_APP_ID)
        .withNamespace(DEFAULT_NAMESPACE)
        .withVersion(DEFAULT_VERSION)
        .withClaim({
          claim: ClaimBuilder.build({groupId: 0xe9ed316946d3d98dfcd829a53ec9822e}),
          proofData: hex"23db86a632326405aca24ae9c3b54c069d44def70169053e90a63640c4596cc80357b3717f116acd6279a7f31ae39c0cccf018cbfaed6a5b6d3933a1835722a023d939a3099876cff4ad9c44517bc19c944903a0758e1b4faa34f7762f7e14872263ea6cdc3e69f25d4dbbad8bc0599c1d21883a0520f531d6d28642a539225e190d839c4e0ca7d350d8f6e09828ddb229ed0ba0ee8aba5b97547df32731066c0af5af9326a6f423d206fa07b7f29819f30e57f5d29578530d8d71d75ff751b602e891d4a4eac7db4ccb032050fe20c79280b3e32ff0347c23378e85c1a8bf29046e3063a940dfabcac8c433cc7f786e89c570c7c36e9af1f8873782b9dc5bc3000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db741405f66939badb0e1c6c5a16e2ed836b35bdbbad92489ad29a0cc7d02627732f04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000",
          provingScheme: DEFAULT_PROVING_SCHEME
        })
        .withSignedMessage({signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE)}),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76312e31000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e9ed316946d3d98dfcd829a53ec9822e000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c023db86a632326405aca24ae9c3b54c069d44def70169053e90a63640c4596cc80357b3717f116acd6279a7f31ae39c0cccf018cbfaed6a5b6d3933a1835722a023d939a3099876cff4ad9c44517bc19c944903a0758e1b4faa34f7762f7e14872263ea6cdc3e69f25d4dbbad8bc0599c1d21883a0520f531d6d28642a539225e190d839c4e0ca7d350d8f6e09828ddb229ed0ba0ee8aba5b97547df32731066c0af5af9326a6f423d206fa07b7f29819f30e57f5d29578530d8d71d75ff751b602e891d4a4eac7db4ccb032050fe20c79280b3e32ff0347c23378e85c1a8bf29046e3063a940dfabcac8c433cc7f786e89c570c7c36e9af1f8873782b9dc5bc3000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db741405f66939badb0e1c6c5a16e2ed836b35bdbbad92489ad29a0cc7d02627732f04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  // simple sismoConnect with 2 claims
  function getResponseWithTwoClaimsAndSignature(
    ICommitmentMapperRegistry commitmentMapperRegistry
  ) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Claim memory claim = ClaimBuilder.build({groupId: 0xe9ed316946d3d98dfcd829a53ec9822e});

    Claim memory claimTwo = ClaimBuilder.build({groupId: 0x02d241fdb9d4330c564ffc0a36af05f6});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](2);
    proofs[0] = ProofBuilder.build({
      claim: claim,
      proofData: hex"10b7f2c1178ac1285b675237a1a161761060499ef62e79b58d53d6017ee5136d2265b1138a2dc39aad2d2224d5c5e6dcc7ef510bb0abdc12241a1c14869f91d808c2d53506e8fbedcc7ef9e25428232d29e5c545d71738cb3c600e629ef2216a101cfdcd821d438d1cc20bc17f2d6708da580d36e98004281dee523cc1dae227101f221f031f3306d7bc8ddc59c5b3481e00e4e1f389a18eeb310cf2a5ecbd8b2374d0401ff22feb086d767d264a5500f34c8309b30eacb7735b5442d87d04950faf1d4bd52f0ae0a530e836b2133ff7e7eea149e492732f40a9225853bd87770f49b76c2afea4389cae7cee79c54b91b9c2ead8a6ca7bec1a4aa6b0c7c54d6b000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db741405f66939badb0e1c6c5a16e2ed836b35bdbbad92489ad29a0cc7d02627732f04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    });
    proofs[1] = ProofBuilder.build({
      claim: claimTwo,
      proofData: hex"0b7c991de76b840392405e432205c53c2574fba9346b6c543c5101f1e71c36c012961dbf3f14e13aab1d38d2f4c4056f0f05303ce87a2f4cc3e8da1bebfc33fa2f947bb5f235002492534442943a3a02ba011239f4678697528edc4b3a8b1dc02f0bab9005e4deded5927066e4ba2f780cd18802b4fb4e5cb66e327cfa3febcb22df1783523ec75303e4b02bed42d802cb29cda8ddfe5024d8e7eb304c80cf432efe4eb5ae7fc59773074f22a46ce281983384d7e5adb3726a5f27f64e330ae22180b88efc3b7c80f9df679daf337a6ec534aecc367c2187fad0b168194889ed14a65f9f90c4531069bfbf7002c414fea8d594745bf11d67eb1e6efbd829b46f000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db741405f66939badb0e1c6c5a16e2ed836b35bdbbad92489ad29a0cc7d02627732f0f1d1d7e673892c9109c8b536253aa86d1d9dbd317ee37e71f22391e3a9fa5b3138cc656a4ed3352a074f68b57d684b33506d71ef40054fa928402c4897d14b8000000000000000000000000000000000000000000000000000000000000000102d241fdb9d4330c564ffc0a36af05f66c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    });

    return (
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1.1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76312e31000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000052000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e9ed316946d3d98dfcd829a53ec9822e000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c010b7f2c1178ac1285b675237a1a161761060499ef62e79b58d53d6017ee5136d2265b1138a2dc39aad2d2224d5c5e6dcc7ef510bb0abdc12241a1c14869f91d808c2d53506e8fbedcc7ef9e25428232d29e5c545d71738cb3c600e629ef2216a101cfdcd821d438d1cc20bc17f2d6708da580d36e98004281dee523cc1dae227101f221f031f3306d7bc8ddc59c5b3481e00e4e1f389a18eeb310cf2a5ecbd8b2374d0401ff22feb086d767d264a5500f34c8309b30eacb7735b5442d87d04950faf1d4bd52f0ae0a530e836b2133ff7e7eea149e492732f40a9225853bd87770f49b76c2afea4389cae7cee79c54b91b9c2ead8a6ca7bec1a4aa6b0c7c54d6b000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db741405f66939badb0e1c6c5a16e2ed836b35bdbbad92489ad29a0cc7d02627732f04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000002d241fdb9d4330c564ffc0a36af05f6000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c00b7c991de76b840392405e432205c53c2574fba9346b6c543c5101f1e71c36c012961dbf3f14e13aab1d38d2f4c4056f0f05303ce87a2f4cc3e8da1bebfc33fa2f947bb5f235002492534442943a3a02ba011239f4678697528edc4b3a8b1dc02f0bab9005e4deded5927066e4ba2f780cd18802b4fb4e5cb66e327cfa3febcb22df1783523ec75303e4b02bed42d802cb29cda8ddfe5024d8e7eb304c80cf432efe4eb5ae7fc59773074f22a46ce281983384d7e5adb3726a5f27f64e330ae22180b88efc3b7c80f9df679daf337a6ec534aecc367c2187fad0b168194889ed14a65f9f90c4531069bfbf7002c414fea8d594745bf11d67eb1e6efbd829b46f000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db741405f66939badb0e1c6c5a16e2ed836b35bdbbad92489ad29a0cc7d02627732f0f1d1d7e673892c9109c8b536253aa86d1d9dbd317ee37e71f22391e3a9fa5b3138cc656a4ed3352a074f68b57d684b33506d71ef40054fa928402c4897d14b8000000000000000000000000000000000000000000000000000000000000000102d241fdb9d4330c564ffc0a36af05f66c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  // simple sismoConnect with only auth
  function getResponseWithOnlyOneAuthAndMessage(
    ICommitmentMapperRegistry commitmentMapperRegistry
  ) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Auth memory auth = AuthBuilder.build({authType: AuthType.VAULT});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](1);
    proofs[0] = ProofBuilder.build({
      auth: auth,
      proofData: hex"138e0d99b4b1fff0128090b63d69da3ccb11b3241ede465119fe13e614e3995f21125ff7d8ff5acdd47a6955c78ecaa079fd4089399f4a92a427e15c3281d8660754ae52a95639d42f53c8b81ed49303a85734b3b9e95e338601ed84c2e8c9920828518d257cb789012f6b2f2c211b02e1062e6623b5aa50dd136eac4fc937ab2dcec087dbeeb3bfe12e255cb5751f6c2f4015a9017cd2f6fbf4a46dcba74eb6290e64a13eaae874d6f6cce1368495dadf20dd5adfb2c801d5cabafa2d078ede270724551d579b5c3d73744a96a8e8a723339d504ac50c71f0a005dca32868d20cdbe42ab4a27fa33ff7388dc1322ce5a2eb2cccf11aaa67a6a755f4ed3d2f1f000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    });

    return (
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1.1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76312e31000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000118202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c0138e0d99b4b1fff0128090b63d69da3ccb11b3241ede465119fe13e614e3995f21125ff7d8ff5acdd47a6955c78ecaa079fd4089399f4a92a427e15c3281d8660754ae52a95639d42f53c8b81ed49303a85734b3b9e95e338601ed84c2e8c9920828518d257cb789012f6b2f2c211b02e1062e6623b5aa50dd136eac4fc937ab2dcec087dbeeb3bfe12e255cb5751f6c2f4015a9017cd2f6fbf4a46dcba74eb6290e64a13eaae874d6f6cce1368495dadf20dd5adfb2c801d5cabafa2d078ede270724551d579b5c3d73744a96a8e8a723339d504ac50c71f0a005dca32868d20cdbe42ab4a27fa33ff7388dc1322ce5a2eb2cccf11aaa67a6a755f4ed3d2f1f000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  // simple sismoConnect with one claim and one auth
  function getResponseWithOneClaimOneAuthAndOneMessage(
    ICommitmentMapperRegistry commitmentMapperRegistry
  ) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Claim memory claim = ClaimBuilder.build({groupId: 0xe9ed316946d3d98dfcd829a53ec9822e});

    Auth memory auth = AuthBuilder.build({authType: AuthType.VAULT});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](2);
    proofs[0] = ProofBuilder.build({
      claim: claim,
      proofData: hex"011f3c4c58c1adec1ffa3200e030a86958ec2659e79d99a2e53384123f038c0b07c3f9e71e3ed89553867d72d10dbb4c14579cf77a86ac9fdd41b74e46eadcb82462df4d58c47a6c5497e2c7fe14b26e9e3411fe2d3b3d77a158aa4d88457a960295965cbd8a452c6cf6aa73f07ef2e8065e0c8ed88b2b509e850bbb441a2c4a11ac55b76bce479a21e0f3813cd4ca85e83f138b86a1658f564e39e087621d5a0ae4b0fcbb49316b0acbc9ecce233bf8a34709651251ca726a19f4ee669798be0da447a5031fb1bea804a1697703685584987b6318bf2d697cf65faa6a21e362247cd3f2c520125e726020d6b90f46fc9a7bcc8e912bed0c1b38d29c2b742872000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db740e997b7c2deffed71b40ef4b01f6a350824d1c54684dd64ea008ff355a2f9a1504f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    });
    proofs[1] = ProofBuilder.build({
      auth: auth,
      proofData: hex"2025e32d784f9885f1dc49a7ad7c01113da08c3869293655340593cb0abb6a5a0046af6b29eea31dce3c4bc29d58570a355334a3e169499da1c4a6be2c12b816025ee4f34d1b004cbe138dd013aa49b204576ab0f90c7fb283d9bba5276127ab14decace2747ed7343c7266ebdd84740c71d65f73cdfd6e4ec6d53b27beeadf40a048a9f2439426b168e72bb90b91a6ee24447a9b4b0e9044120bdcb9cabe0a2201a6ff2979a9a3fd677d24ca69d121f95e62be9f7e59373af3f7ffef8f294b52b3c915194169f7170fad8ec011837f5c7dc3ea92c6ea11e8d0a5470effd4f4b25a49d6b3b88c7b2ad60f329a576170157c102e4c90f37fcfbebb3fc4907b41e000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    });

    return (
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1.1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76312e31000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000118202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c02025e32d784f9885f1dc49a7ad7c01113da08c3869293655340593cb0abb6a5a0046af6b29eea31dce3c4bc29d58570a355334a3e169499da1c4a6be2c12b816025ee4f34d1b004cbe138dd013aa49b204576ab0f90c7fb283d9bba5276127ab14decace2747ed7343c7266ebdd84740c71d65f73cdfd6e4ec6d53b27beeadf40a048a9f2439426b168e72bb90b91a6ee24447a9b4b0e9044120bdcb9cabe0a2201a6ff2979a9a3fd677d24ca69d121f95e62be9f7e59373af3f7ffef8f294b52b3c915194169f7170fad8ec011837f5c7dc3ea92c6ea11e8d0a5470effd4f4b25a49d6b3b88c7b2ad60f329a576170157c102e4c90f37fcfbebb3fc4907b41e000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e9ed316946d3d98dfcd829a53ec9822e000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c0011f3c4c58c1adec1ffa3200e030a86958ec2659e79d99a2e53384123f038c0b07c3f9e71e3ed89553867d72d10dbb4c14579cf77a86ac9fdd41b74e46eadcb82462df4d58c47a6c5497e2c7fe14b26e9e3411fe2d3b3d77a158aa4d88457a960295965cbd8a452c6cf6aa73f07ef2e8065e0c8ed88b2b509e850bbb441a2c4a11ac55b76bce479a21e0f3813cd4ca85e83f138b86a1658f564e39e087621d5a0ae4b0fcbb49316b0acbc9ecce233bf8a34709651251ca726a19f4ee669798be0da447a5031fb1bea804a1697703685584987b6318bf2d697cf65faa6a21e362247cd3f2c520125e726020d6b90f46fc9a7bcc8e912bed0c1b38d29c2b742872000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db740e997b7c2deffed71b40ef4b01f6a350824d1c54684dd64ea008ff355a2f9a1504f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  function getResponseWithTwoClaimsOneAuthAndOneSignature(
    ICommitmentMapperRegistry commitmentMapperRegistry
  ) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Claim memory claim = ClaimBuilder.build({groupId: 0xe9ed316946d3d98dfcd829a53ec9822e});

    Claim memory claimTwo = ClaimBuilder.build({groupId: 0x02d241fdb9d4330c564ffc0a36af05f6});

    Auth memory auth = AuthBuilder.build({authType: AuthType.VAULT});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](3);
    proofs[0] = ProofBuilder.build({
      claim: claim,
      proofData: hex"28405cbd0f7b6dfb448846e5d33ec4dbefb82d3f02b22a05ae84371331f1fad225f7b386db5bb2142d2a7dcc91145fbf36c3f44408935cb2b26bda805ebcb9a92d0b259a5b63ee528c2f579cad451ec60ead17fcef2d09e8eda0a9daa2228ade2b7d245e7ae807f35b9d695bae8e5e261ec2e67934be61de5eadf04d85da96f41f39737f5a911199a526d8a5a1c4b8b3b005d1a292f1c18b267def3fd299f38c003dc0ab9ff18d76a0d58925cb37d95cc400161c124f2a1fb3f2d98759a66ef509093ec0115f297f386077bafd61814777162a262f03966bd33a2225fcdc07062ebaf89e041a0bec6324f4c3eef52d755c5e3695f9f4b0e3389071fb8e991412000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db740e997b7c2deffed71b40ef4b01f6a350824d1c54684dd64ea008ff355a2f9a1504f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    });

    proofs[1] = ProofBuilder.build({
      claim: claimTwo,
      proofData: hex"10fbe15da1968075d3bf43bd8c2ac092dce0534a9f2fdd8030caacab0784e8c41b0148ff4b9c8dd71499eba017733b9e6f2a0ba41cbb47c08dc1865081d2b927189c073fd3fb24324f361f981d4f11a4ca34afdef8a0b571dbb20f7d7580dbb8003ac50fb2bfa8a960efa70ac313621d1594c5525c8584b2961628a90ed6aeb419585c6ca7c8d24474d865a955db888a4032fcf4f17e98153c77415436214df60083a361b2280997a424c2b5d93d8ba191e0d1770dfe8ac54169f29b94f71dce1b1ccd4797da423a773a357abcffa3167e1d7dfa7180104b91a7658912a22b1b1a377b3d57b12a1b7a6dbeddcdbb33fe82d3d8f79c255ab9548ddbe6489147d6000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db740e997b7c2deffed71b40ef4b01f6a350824d1c54684dd64ea008ff355a2f9a150f1d1d7e673892c9109c8b536253aa86d1d9dbd317ee37e71f22391e3a9fa5b3138cc656a4ed3352a074f68b57d684b33506d71ef40054fa928402c4897d14b8000000000000000000000000000000000000000000000000000000000000000102d241fdb9d4330c564ffc0a36af05f66c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    });

    proofs[2] = ProofBuilder.build({
      auth: auth,
      proofData: hex"2b4a417535582afc195384462a5067cbc352f0df90dca372da6295f8e26f798a0c6347ec27ecb3073f3bcafcb8f671e3e8f65d3d092f93309953986306524ace022943161f3f8a03ef5f38aabba3e875a0d409533ea02534155a3131ccec063f07de84d593af3a366d54f6780e84fba16f991261001efe9a788e5c9a96f2749912fb83ac0e08f43a5fe943b850bf1e8531ac5ab3ed60260fd0d9c43668118b59244070ccd714b28cdd8cfd63ff9a18fa600c9607f73175c4373893d0260286781cc137a570847b2a8a592211f4ac98d75b752564cdd89e8da1561b927f28cfca1b104c0d70f11cc693bd9021a4448706d631668200d76a8b8e43279ef4b55431000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    });

    return (
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1.1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76312e31000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae0000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000005200000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000118202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c02b4a417535582afc195384462a5067cbc352f0df90dca372da6295f8e26f798a0c6347ec27ecb3073f3bcafcb8f671e3e8f65d3d092f93309953986306524ace022943161f3f8a03ef5f38aabba3e875a0d409533ea02534155a3131ccec063f07de84d593af3a366d54f6780e84fba16f991261001efe9a788e5c9a96f2749912fb83ac0e08f43a5fe943b850bf1e8531ac5ab3ed60260fd0d9c43668118b59244070ccd714b28cdd8cfd63ff9a18fa600c9607f73175c4373893d0260286781cc137a570847b2a8a592211f4ac98d75b752564cdd89e8da1561b927f28cfca1b104c0d70f11cc693bd9021a4448706d631668200d76a8b8e43279ef4b55431000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e9ed316946d3d98dfcd829a53ec9822e000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c028405cbd0f7b6dfb448846e5d33ec4dbefb82d3f02b22a05ae84371331f1fad225f7b386db5bb2142d2a7dcc91145fbf36c3f44408935cb2b26bda805ebcb9a92d0b259a5b63ee528c2f579cad451ec60ead17fcef2d09e8eda0a9daa2228ade2b7d245e7ae807f35b9d695bae8e5e261ec2e67934be61de5eadf04d85da96f41f39737f5a911199a526d8a5a1c4b8b3b005d1a292f1c18b267def3fd299f38c003dc0ab9ff18d76a0d58925cb37d95cc400161c124f2a1fb3f2d98759a66ef509093ec0115f297f386077bafd61814777162a262f03966bd33a2225fcdc07062ebaf89e041a0bec6324f4c3eef52d755c5e3695f9f4b0e3389071fb8e991412000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db740e997b7c2deffed71b40ef4b01f6a350824d1c54684dd64ea008ff355a2f9a1504f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000002d241fdb9d4330c564ffc0a36af05f6000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c010fbe15da1968075d3bf43bd8c2ac092dce0534a9f2fdd8030caacab0784e8c41b0148ff4b9c8dd71499eba017733b9e6f2a0ba41cbb47c08dc1865081d2b927189c073fd3fb24324f361f981d4f11a4ca34afdef8a0b571dbb20f7d7580dbb8003ac50fb2bfa8a960efa70ac313621d1594c5525c8584b2961628a90ed6aeb419585c6ca7c8d24474d865a955db888a4032fcf4f17e98153c77415436214df60083a361b2280997a424c2b5d93d8ba191e0d1770dfe8ac54169f29b94f71dce1b1ccd4797da423a773a357abcffa3167e1d7dfa7180104b91a7658912a22b1b1a377b3d57b12a1b7a6dbeddcdbb33fe82d3d8f79c255ab9548ddbe6489147d6000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db740e997b7c2deffed71b40ef4b01f6a350824d1c54684dd64ea008ff355a2f9a150f1d1d7e673892c9109c8b536253aa86d1d9dbd317ee37e71f22391e3a9fa5b3138cc656a4ed3352a074f68b57d684b33506d71ef40054fa928402c4897d14b8000000000000000000000000000000000000000000000000000000000000000102d241fdb9d4330c564ffc0a36af05f66c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  function getResponseWithGitHubAuth(
    ICommitmentMapperRegistry commitmentMapperRegistry
  ) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Auth memory auth = AuthBuilder.build({authType: AuthType.GITHUB});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](1);
    proofs[0] = ProofBuilder.build({
      auth: auth,
      proofData: hex"24faaaeb6aa12f1d20d9af00e365e5cdde1c80bf51a1bc1ccf200e769d753e491788e1ab17611d93332528b2c605786607b568db08f612d53fe92d16e2a2fdfc26b20a04ae5f8669bef6d0483d4c0f2d07097f50ec704836a72b7a83dcc1da34091d4bfc5c010244f15c2d431840244b74bd3a879bf726f70e920339e81ea16416ac3379751c4a7bb1cf78aa7bf50b8251a12925ecf71eba72a4d4be5d15c4412bc12c9aba2b14029f93ce527147f3431953ea883e7e8988554699d945a418b800290795426240bb8cbc589c8624513ef092b56a014a43c4278d89475db8e96a07eab298470d6494a21a1e5e5a0878fe615d123e4e849acc7288fe7e14039e5b000000000000000000000000100100000000000000000000000000009999037009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"
    });

    return (
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1.1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76312e31000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000100100000000000000000000000000009999037000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c024faaaeb6aa12f1d20d9af00e365e5cdde1c80bf51a1bc1ccf200e769d753e491788e1ab17611d93332528b2c605786607b568db08f612d53fe92d16e2a2fdfc26b20a04ae5f8669bef6d0483d4c0f2d07097f50ec704836a72b7a83dcc1da34091d4bfc5c010244f15c2d431840244b74bd3a879bf726f70e920339e81ea16416ac3379751c4a7bb1cf78aa7bf50b8251a12925ecf71eba72a4d4be5d15c4412bc12c9aba2b14029f93ce527147f3431953ea883e7e8988554699d945a418b800290795426240bb8cbc589c8624513ef092b56a014a43c4278d89475db8e96a07eab298470d6494a21a1e5e5a0878fe615d123e4e849acc7288fe7e14039e5b000000000000000000000000100100000000000000000000000000009999037009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  function getResponseWithGitHubAuthWithoutSignature(
    ICommitmentMapperRegistry commitmentMapperRegistry
  ) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Auth memory auth = AuthBuilder.build({authType: AuthType.GITHUB});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](1);
    proofs[0] = ProofBuilder.build({
      auth: auth,
      proofData: hex"1303ed52f42506122350d08ee27699103d936e700e472584c58b47a6619ce03d0bc4d07fe6d6a8ec6ab1d08999036c8395c53229e48d5663e0669b9a0c44d22c2f8887d5de6e598bd0f080054bcd3aeab4314d1f11a59de0c421582c3fa7b6e82816b1f74b46b339dd14562a253e1c32c04236b99e728248225a9714e305e19a12eb3e69ea503962acb06edca492b5277319e340220ab2b3e840950fa8eabaff1c64510cbd29dbddcd96cd7e9647f8451d6679270f5fb8d934ec8932d1d1006e008a09276a627ddba73e7cf85a427d93b2eb64751210e1e6a4d2cccb3005f5c4268bc5912a59b3c2aebf1dcfaeafcb99bcfea16376241e9c85547b39b1880d22000000000000000000000000100100000000000000000000000000009999037000000000000000000000000000000000000000000000000000000000000000002ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"
    });

    return (
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1.1"),
        signedMessage: "",
        proofs: proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76312e31000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73332e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000100100000000000000000000000000009999037000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c01303ed52f42506122350d08ee27699103d936e700e472584c58b47a6619ce03d0bc4d07fe6d6a8ec6ab1d08999036c8395c53229e48d5663e0669b9a0c44d22c2f8887d5de6e598bd0f080054bcd3aeab4314d1f11a59de0c421582c3fa7b6e82816b1f74b46b339dd14562a253e1c32c04236b99e728248225a9714e305e19a12eb3e69ea503962acb06edca492b5277319e340220ab2b3e840950fa8eabaff1c64510cbd29dbddcd96cd7e9647f8451d6679270f5fb8d934ec8932d1d1006e008a09276a627ddba73e7cf85a427d93b2eb64751210e1e6a4d2cccb3005f5c4268bc5912a59b3c2aebf1dcfaeafcb99bcfea16376241e9c85547b39b1880d22000000000000000000000000100100000000000000000000000000009999037000000000000000000000000000000000000000000000000000000000000000002ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    );
  }
}
