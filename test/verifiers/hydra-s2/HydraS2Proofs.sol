// SPDX-License-Identifier: Unlicense
pragma solidity ^0.8.17;

import "forge-std/console.sol";
import "src/libs/utils/Structs.sol";
import {AuthBuilder} from "src/libs/utils/AuthBuilder.sol";
import {ClaimBuilder} from "src/libs/utils/ClaimBuilder.sol";
import {ProofBuilder} from "src/libs/utils/SismoConnectProofBuilder.sol";
import {ResponseBuilder} from "test/utils/ResponseBuilderLib.sol";
import {ICommitmentMapperRegistry} from "test/mocks/CommitmentMapperRegistryMock.sol";

contract HydraS2Proofs {
  using ResponseBuilder for SismoConnectResponse;

  // default value for Claim
  bytes16 public constant DEFAULT_CLAIM_GROUP_TIMESTAMP = bytes16("latest");
  uint256 public constant DEFAULT_CLAIM_VALUE = 1;
  bytes16 public constant DEFAULT_CLAIM_GROUP_ID = "";
  ClaimType public constant DEFAULT_CLAIM_TYPE = ClaimType.GTE;
  bytes public constant DEFAULT_CLAIM_EXTRA_DATA = "";

  // default values for Auth
  bool public constant DEFAULT_AUTH_ANON_MODE = false;
  uint256 public constant DEFAULT_AUTH_USER_ID = 0;
  bytes public constant DEFAULT_AUTH_EXTRA_DATA = "";

  // default values for MessageSignature
  bytes public constant DEFAULT_MESSAGE_SIGNATURE_REQUEST = "MESSAGE_SELECTED_BY_USER";

  // default value for appId
  bytes16 public constant DEFAULT_APP_ID = 0x11b1de449c6c4adb0b5775b3868b28b3;
  // default value for namespace
  bytes16 public constant DEFAULT_NAMESPACE = bytes16(keccak256("main"));

  // default value for version
  bytes32 public constant DEFAULT_VERSION = bytes32("sismo-connect-v1");

  // default proving scheme
  bytes32 public constant DEFAULT_PROVING_SCHEME = bytes32("hydra-s2.1");

  function getEdDSAPubKey() public pure returns (uint256[2] memory) {
    return [
      0x7f6c5612eb579788478789deccb06cf0eb168e457eea490af754922939ebdb9,
      0x20706798455f90ed993f8dac8075fc1538738a25f0c928da905c0dffd81869fa
    ];
  }

  function getEdDSAPubKeyDevBeta() public pure returns (uint256[2] memory) {
    return [
      0x2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f0256, 
      0x30423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db74
    ];
  }

  function getRoot() public pure returns (uint256) {
    return 0x1d4a72bd1c1e4f9ab68c3c4c55afd3e582685a18b9ec09fc96136619d2513fe8;
  }

  // simple sismoConnect with 1 claim
  function getResponseWithOneClaimAndSignature(ICommitmentMapperRegistry commitmentMapperRegistry) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    uint256[2] memory devBetaCommitmentMapperPubKey = [
      0x2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f0256, 
      0x30423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db74
    ];
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(devBetaCommitmentMapperPubKey);

    return (
      ResponseBuilder.empty()
        .withAppId(DEFAULT_APP_ID)
        .withNamespace(DEFAULT_NAMESPACE)
        .withVersion(DEFAULT_VERSION)
        .withClaim({
          claim: ClaimBuilder.build({groupId: 0xe9ed316946d3d98dfcd829a53ec9822e}),
          proofData: hex"27ca7bd6a6cbbcbd9e63555e5223879bcc514eb97c61332c327e829c012310d8054d9f84a4cb4ff30ba1d77b416b16f590fb60087448cc7ff03965c14383ef3215f1d26bd3737a75e4e6912d6111ab6b8e4f1670fc9a761fade10ee1eb94506f1a5f8a673e428325f1912c641fccbb0fe0703b7449defcb9967f71a62933acc4161a4a6a696ca032650649e442a2692a2d92e51fda9682dbeb4ed0c0d19c05dc25437d7c4762ad9e68ac4d082ecde8f09fa43f3ebbbc4c6d0b8a56d130b4952a2aba0c552b4b35e67f39aadcacb269baaec1745cf3af2777546db0762afa74e90597850eaa715bee811d28871492bc06a09c4fb6a5cf7dbe8e40c1887504662b000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000",
          provingScheme: DEFAULT_PROVING_SCHEME
        })
        .withSignedMessage({signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE)}),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e9ed316946d3d98dfcd829a53ec9822e000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c027ca7bd6a6cbbcbd9e63555e5223879bcc514eb97c61332c327e829c012310d8054d9f84a4cb4ff30ba1d77b416b16f590fb60087448cc7ff03965c14383ef3215f1d26bd3737a75e4e6912d6111ab6b8e4f1670fc9a761fade10ee1eb94506f1a5f8a673e428325f1912c641fccbb0fe0703b7449defcb9967f71a62933acc4161a4a6a696ca032650649e442a2692a2d92e51fda9682dbeb4ed0c0d19c05dc25437d7c4762ad9e68ac4d082ecde8f09fa43f3ebbbc4c6d0b8a56d130b4952a2aba0c552b4b35e67f39aadcacb269baaec1745cf3af2777546db0762afa74e90597850eaa715bee811d28871492bc06a09c4fb6a5cf7dbe8e40c1887504662b000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
      );
  }

  // simple sismoConnect with 2 claims
  function getResponseWithTwoClaimsAndSignature(ICommitmentMapperRegistry commitmentMapperRegistry) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Claim memory claim = ClaimBuilder.build({
      groupId: 0xe9ed316946d3d98dfcd829a53ec9822e
    });

    Claim memory claimTwo = ClaimBuilder.build({
      groupId: 0x02d241fdb9d4330c564ffc0a36af05f6
    });

    SismoConnectProof[] memory proofs = new SismoConnectProof[](2);
    proofs[0] = ProofBuilder.build({
      claim: claim,
      proofData: hex"2e5cf1b3f104d4ccc89dcfadd31d2b7e93efc16627d46669fb0e312474c6216615faac81b94ab3af13440d3d4fdc61556bb7188e4d0613e9a26a5d7ef21001c1205401426985291ac6753b95f0e5d5a4de4f50a1c6fe47c4d4ea9a7bb74acabb1e1f88282d6b47f56a95d857d536d20a08301394158670abf26f59c8166b358515143506e9c4fb17a03e86bbf30a07fc9ec3e9fabfeeb00f3ba4cef21e6c91340fa0125d13af3d08269af1c1dbded3d01b0da32763d2f041d07c24161509adf70f6417ac6e636b42c07135a42f3d83fe8cfaf085b6ed75928a810c6a68c0b6b0096fed5d8877e7b3ba233b97ec0661368d0ed3d04ba02049f3843d9f2a622728000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    });
    proofs[1] = ProofBuilder.build({
      claim: claimTwo,
      proofData: hex"0722e3e083d07c8d1e83d49345fe926ce2a526bf13de429ed82f67a208fb7b7d060a15f4631cfc683b9757d82215a80a69bcf55581937db03b02d784dd7dc07e01e500d510d465b6ef605574e78bbc8f1d177b9c45818aa9839f0ddee824b30313514b0d9a662598a453d8a7821609bae6a4c48565f95d9213ba6e35cfa62d4d162be7f58e382a3057281d9ab7bcbaf12c1c2a4d52ec4d39ad918269240aa72816d6606372807953a95638ba2b731c4eb1ef0edbd682f5827c1b5e0215ae7d0e05122f5a4b8ee9860ff27889faf6eed5cd8aef1419fa26e6e0dd03850ae8de620db13528c6b99b9c2f55a0b707cb18c1fbe9d4d89f2edbf2aaed1b6e94ac7e70000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d0f1d1d7e673892c9109c8b536253aa86d1d9dbd317ee37e71f22391e3a9fa5b3138cc656a4ed3352a074f68b57d684b33506d71ef40054fa928402c4897d14b8000000000000000000000000000000000000000000000000000000000000000102d241fdb9d4330c564ffc0a36af05f66c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    });

    return(
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000052000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e9ed316946d3d98dfcd829a53ec9822e000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c02e5cf1b3f104d4ccc89dcfadd31d2b7e93efc16627d46669fb0e312474c6216615faac81b94ab3af13440d3d4fdc61556bb7188e4d0613e9a26a5d7ef21001c1205401426985291ac6753b95f0e5d5a4de4f50a1c6fe47c4d4ea9a7bb74acabb1e1f88282d6b47f56a95d857d536d20a08301394158670abf26f59c8166b358515143506e9c4fb17a03e86bbf30a07fc9ec3e9fabfeeb00f3ba4cef21e6c91340fa0125d13af3d08269af1c1dbded3d01b0da32763d2f041d07c24161509adf70f6417ac6e636b42c07135a42f3d83fe8cfaf085b6ed75928a810c6a68c0b6b0096fed5d8877e7b3ba233b97ec0661368d0ed3d04ba02049f3843d9f2a622728000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000002d241fdb9d4330c564ffc0a36af05f6000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c00722e3e083d07c8d1e83d49345fe926ce2a526bf13de429ed82f67a208fb7b7d060a15f4631cfc683b9757d82215a80a69bcf55581937db03b02d784dd7dc07e01e500d510d465b6ef605574e78bbc8f1d177b9c45818aa9839f0ddee824b30313514b0d9a662598a453d8a7821609bae6a4c48565f95d9213ba6e35cfa62d4d162be7f58e382a3057281d9ab7bcbaf12c1c2a4d52ec4d39ad918269240aa72816d6606372807953a95638ba2b731c4eb1ef0edbd682f5827c1b5e0215ae7d0e05122f5a4b8ee9860ff27889faf6eed5cd8aef1419fa26e6e0dd03850ae8de620db13528c6b99b9c2f55a0b707cb18c1fbe9d4d89f2edbf2aaed1b6e94ac7e70000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d0f1d1d7e673892c9109c8b536253aa86d1d9dbd317ee37e71f22391e3a9fa5b3138cc656a4ed3352a074f68b57d684b33506d71ef40054fa928402c4897d14b8000000000000000000000000000000000000000000000000000000000000000102d241fdb9d4330c564ffc0a36af05f66c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  // simple sismoConnect with only auth
  function getResponseWithOnlyOneAuthAndMessage(ICommitmentMapperRegistry commitmentMapperRegistry) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Auth memory auth = AuthBuilder.build({authType: AuthType.VAULT});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](1);
    proofs[0] = ProofBuilder.build({
      auth: auth,
      proofData: hex"14aa2f6c84dcc49c82e5cccf754744c1fc750bc6dea92e257a7d8a729ccb7cd31b457815943cc43094122121a6fd7feff8b6e02d48c449057a04d7d64c4a04f52e085167971c13a11f6edbaf8c4a06a86d168b656a4db0c03f3df3d17491b183059310bd5b3a3f364b257f3bfed41e7f004ff547879ad2d4515928289b601d562a90a6c90d5a82100e8f0afb3e2f99131d5583cc7c87c9d3c00c480f01bbd6d1289c65b2494d0bda76fcc4837433cdb4a8338c872c48b3282e345934f7d6805e0126b73f4510241f5b436140119e4c3e58fe2dd6c8e0425336a696f9f9d7726313271daaab3fcee024cdc78d0fa0d1274de5883777bf799c5d21904ec26e61ed000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    });

    return(
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000118202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c014aa2f6c84dcc49c82e5cccf754744c1fc750bc6dea92e257a7d8a729ccb7cd31b457815943cc43094122121a6fd7feff8b6e02d48c449057a04d7d64c4a04f52e085167971c13a11f6edbaf8c4a06a86d168b656a4db0c03f3df3d17491b183059310bd5b3a3f364b257f3bfed41e7f004ff547879ad2d4515928289b601d562a90a6c90d5a82100e8f0afb3e2f99131d5583cc7c87c9d3c00c480f01bbd6d1289c65b2494d0bda76fcc4837433cdb4a8338c872c48b3282e345934f7d6805e0126b73f4510241f5b436140119e4c3e58fe2dd6c8e0425336a696f9f9d7726313271daaab3fcee024cdc78d0fa0d1274de5883777bf799c5d21904ec26e61ed000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
      );
  }

  // simple sismoConnect with one claim and one auth
  function getResponseWithOneClaimOneAuthAndOneMessage(ICommitmentMapperRegistry commitmentMapperRegistry) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Claim memory claim = ClaimBuilder.build({
      groupId: 0xe9ed316946d3d98dfcd829a53ec9822e
    });

    Auth memory auth = AuthBuilder.build({authType: AuthType.VAULT});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](2);
    proofs[0] = ProofBuilder.build({
      claim: claim,
      proofData: hex"1294176a5da8a7e1d5bb4b1195eda61fadf7415ffc4f7c4b39dac5dd3bf5a68a00f290aea5859f3f40ac7c0687a398bb8bfbe445c562e833da27ce3263708f99212938a6ffec086c6fb92c0f5da261d359bc7c91f71bb29fb3e5fbd6872b8a030db6c2a0ddb6e0644df9fe9a6a97aa9b27427b2447d56813f8975c628713dca513770bdaf7322fea02bbd58e48591bc23cb5d354668e1ac8b0f53bd90ec16423164a0eb6720c9b0a6f233173bd87f7d6b0fcb62d0d366713d0d74bf149f1937a12194b1cc7a0f78975d4cff473a1d964a405cf0275507db8c5707e6e3048090f2c6b527a000fe9b0df7fa5fc65ba2b44e0fe4651e8140761a2cfa2479b169dba000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"  
    });
    proofs[1] = ProofBuilder.build({
      auth: auth,
      proofData: hex"00d19bb2a26cb23fde9960921f6d9c24b0640e1c1333ba7243cea550c70a7d810fdbd5b0373b44b932523d1c96eed4dc77d890b2be395e607cb5b909ae6285f708eb386a1da179ca72a25190c045621ff6222f1c0c7d196f529a9e9a622ab537042e8092dd77898b491c0cbce2077f770e86cef9692972b50ad23aabd2db8584038a06be256bb16bd22249ae23e0ee29b4e29e0b094d14ac52c1515ed4d28e471c04c0db89fb3a1bc28013eac188520aacee8d0d581d5b51e42f3fd22753b471029fbca4b4acbc76bc21437ca2c07dc97a88b0abaebc3fb997e8d7cf117737a61fb23f1560d50c768d33eb012d54611bb49dda382fd0b20e8c277391137cad13000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    });

    return(
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000052000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e9ed316946d3d98dfcd829a53ec9822e000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c01294176a5da8a7e1d5bb4b1195eda61fadf7415ffc4f7c4b39dac5dd3bf5a68a00f290aea5859f3f40ac7c0687a398bb8bfbe445c562e833da27ce3263708f99212938a6ffec086c6fb92c0f5da261d359bc7c91f71bb29fb3e5fbd6872b8a030db6c2a0ddb6e0644df9fe9a6a97aa9b27427b2447d56813f8975c628713dca513770bdaf7322fea02bbd58e48591bc23cb5d354668e1ac8b0f53bd90ec16423164a0eb6720c9b0a6f233173bd87f7d6b0fcb62d0d366713d0d74bf149f1937a12194b1cc7a0f78975d4cff473a1d964a405cf0275507db8c5707e6e3048090f2c6b527a000fe9b0df7fa5fc65ba2b44e0fe4651e8140761a2cfa2479b169dba000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000118202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c000d19bb2a26cb23fde9960921f6d9c24b0640e1c1333ba7243cea550c70a7d810fdbd5b0373b44b932523d1c96eed4dc77d890b2be395e607cb5b909ae6285f708eb386a1da179ca72a25190c045621ff6222f1c0c7d196f529a9e9a622ab537042e8092dd77898b491c0cbce2077f770e86cef9692972b50ad23aabd2db8584038a06be256bb16bd22249ae23e0ee29b4e29e0b094d14ac52c1515ed4d28e471c04c0db89fb3a1bc28013eac188520aacee8d0d581d5b51e42f3fd22753b471029fbca4b4acbc76bc21437ca2c07dc97a88b0abaebc3fb997e8d7cf117737a61fb23f1560d50c768d33eb012d54611bb49dda382fd0b20e8c277391137cad13000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  function getResponseWithTwoClaimsOneAuthAndOneSignature(ICommitmentMapperRegistry commitmentMapperRegistry) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

     Claim memory claim = ClaimBuilder.build({
      groupId: 0xe9ed316946d3d98dfcd829a53ec9822e
    });

    Claim memory claimTwo = ClaimBuilder.build({
      groupId: 0x02d241fdb9d4330c564ffc0a36af05f6
    });

    Auth memory auth = AuthBuilder.build({authType: AuthType.VAULT});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](3);
    proofs[0] = ProofBuilder.build({
      claim: claim,
      proofData: hex"24a86dc0cd36378e002d52255dc13fb9a81f5bbd0bde2f76594043e2438550081c2e189722a92631b64ed1c2cb189c6b42848aa8f2644253424ae4bb8ab68bf61f7f51d8331ea5603a59d4953cc8fcf37125ee35ec30b334e3d5e30cde170f7b1ac22d7d6b85a2d04319e4ad98337747b490e4f909dd7a4428bbe0e6c4b454720889f18e371c8c2e5421b382f5c03ee3fc06158412101e8f6f6e5ab1f230009408dd11acc6ff61f0edb11e3b388e976f536754c5fb6d3256840b89aceabecad2206ef6967d52791625458707769e56aed75df9bdaf6f13996d1555c62aa92c821916d1044cea33693abaf312c3440a4c1d7e501c6238dbda5803fcb21486179e000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    });

    proofs[1] = ProofBuilder.build({
      claim: claimTwo,
      proofData: hex"09efa29bb7fdf6b4e1ba9ab16a62aa0feb9be7344b53bd88e5b95d30587292842716e0f4babda59fd82f785e15cac956e46151a2738b0936b14714c9b5d659b600de05e747c4576f1ce4a1117bf4adda668114783b1693d1567965eaa835c5991c7fbd2012c164d73b07ddb2aa4e1872ff2208e7a78fbee557c7b4eef8879b8016a5b217655e78bd1936b210d3b0d80506d0c2f2057ceb7a21d54ab336c4828b2fee29e0294af3572f815c4592072fc4eb4041d1e74faa3ae3d480350b88526d1547fab13190a742bb0ab9e06bd4ab541ebd762a1cce29b0f13cab59e0d5ff1e19633668b98d3e98bfab91eaa9cae8d67adc81ecf7d9686873012bafa8e90a30000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d0f1d1d7e673892c9109c8b536253aa86d1d9dbd317ee37e71f22391e3a9fa5b3138cc656a4ed3352a074f68b57d684b33506d71ef40054fa928402c4897d14b8000000000000000000000000000000000000000000000000000000000000000102d241fdb9d4330c564ffc0a36af05f66c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    });

    proofs[2] = ProofBuilder.build({
      auth: auth,
      proofData: hex"0b7aa9c6b2fee8f3646b64a29673f68d14098399c539835b63a57e02ba39ef091dd812ec2f697019c2d434852a6b277e54150fc396d7e2a67b0e6205c8f4dfd9246d028c6702f344ba0ee290a787087666cf2a24c50b79d8a65366e234a7324f28971d5ac637c73ad1f306de1c787ebdb07dd4a0e762eb6092219880e1e7191a054035b9cba977b3d50cae913509c825edaf050df9daa3de80ee8c4c34fe25e713eedeba779157a1613cdd302e5e0445db7d3d1a1df16a39ccc11defeb1e5b292e50094fa3e8e7f3453dc4b9fd99cdd2e03320bf4265c081bbff4384ace2417e065e723020cfdfbc799b743e1c454396edcc29a247d84b5b251ee0c78b2fbe7a000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    });

    return(
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: response.proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae0000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000005400000000000000000000000000000000000000000000000000000000000000a2000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000e9ed316946d3d98dfcd829a53ec9822e000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c024a86dc0cd36378e002d52255dc13fb9a81f5bbd0bde2f76594043e2438550081c2e189722a92631b64ed1c2cb189c6b42848aa8f2644253424ae4bb8ab68bf61f7f51d8331ea5603a59d4953cc8fcf37125ee35ec30b334e3d5e30cde170f7b1ac22d7d6b85a2d04319e4ad98337747b490e4f909dd7a4428bbe0e6c4b454720889f18e371c8c2e5421b382f5c03ee3fc06158412101e8f6f6e5ab1f230009408dd11acc6ff61f0edb11e3b388e976f536754c5fb6d3256840b89aceabecad2206ef6967d52791625458707769e56aed75df9bdaf6f13996d1555c62aa92c821916d1044cea33693abaf312c3440a4c1d7e501c6238dbda5803fcb21486179e000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d04f81599b826fa9b715033e76e5b2fdda881352a9b61360022e30ee33ddccad90744e9b92802056c722ac4b31612e1b1de544d5b99481386b162a0b59862e0850000000000000000000000000000000000000000000000000000000000000001285bf79dc20d58e71b9712cb38c420b9cb91d3438c8e3dbaf07829b03ffffffc000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000c068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e000000000000000000000000000000000000000000000000000000000000004c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000002d241fdb9d4330c564ffc0a36af05f6000000000000000000000000000000006c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c009efa29bb7fdf6b4e1ba9ab16a62aa0feb9be7344b53bd88e5b95d30587292842716e0f4babda59fd82f785e15cac956e46151a2738b0936b14714c9b5d659b600de05e747c4576f1ce4a1117bf4adda668114783b1693d1567965eaa835c5991c7fbd2012c164d73b07ddb2aa4e1872ff2208e7a78fbee557c7b4eef8879b8016a5b217655e78bd1936b210d3b0d80506d0c2f2057ceb7a21d54ab336c4828b2fee29e0294af3572f815c4592072fc4eb4041d1e74faa3ae3d480350b88526d1547fab13190a742bb0ab9e06bd4ab541ebd762a1cce29b0f13cab59e0d5ff1e19633668b98d3e98bfab91eaa9cae8d67adc81ecf7d9686873012bafa8e90a30000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7408642c70876b81cb23b3ec10faeb472fb0d463430bcb4ef2a2715e5a0fe67d3d0f1d1d7e673892c9109c8b536253aa86d1d9dbd317ee37e71f22391e3a9fa5b3138cc656a4ed3352a074f68b57d684b33506d71ef40054fa928402c4897d14b8000000000000000000000000000000000000000000000000000000000000000102d241fdb9d4330c564ffc0a36af05f66c617465737400000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000118202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c00b7aa9c6b2fee8f3646b64a29673f68d14098399c539835b63a57e02ba39ef091dd812ec2f697019c2d434852a6b277e54150fc396d7e2a67b0e6205c8f4dfd9246d028c6702f344ba0ee290a787087666cf2a24c50b79d8a65366e234a7324f28971d5ac637c73ad1f306de1c787ebdb07dd4a0e762eb6092219880e1e7191a054035b9cba977b3d50cae913509c825edaf050df9daa3de80ee8c4c34fe25e713eedeba779157a1613cdd302e5e0445db7d3d1a1df16a39ccc11defeb1e5b292e50094fa3e8e7f3453dc4b9fd99cdd2e03320bf4265c081bbff4384ace2417e065e723020cfdfbc799b743e1c454396edcc29a247d84b5b251ee0c78b2fbe7a000000000000000000000000000000000000000000000000000000000000000009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  function getResponseWithGitHubAuth(ICommitmentMapperRegistry commitmentMapperRegistry) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Auth memory auth = AuthBuilder.build({authType: AuthType.GITHUB});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](1);
    proofs[0] = ProofBuilder.build({
      auth: auth,
      proofData: hex"04a229a4e5c5d8cee7e3578af8e704062c5aa27df2cef1b2b160f70ed8f9dae52805649ea3434124a60e87f5f66c7be677ec386484814cfd1fecff41065c8fa10b5184f6d352683c28753040ca96e87a64613c1c139085bea9a45740fe46d7322805c20bd78b9a81b4329fe7e7c2fb68374f996903fdf79e72ca98b1aaf572ca292079ebcf188bc4d7f80bc5ef8931a63f251ca6be0dc21c1aaeeed310d0f46d07711636b38e8812e6871c2a0b488acba7853a575ed77dda01e33b1a7c847dc2299cfa02050ba9f1cb20a74bf96634628bfa3f36fc72641a848b82fd9d08696101513fabac96d1bf451207abc436507bf82fc32863a349706c0fda6155555a8a000000000000000000000000100100000000000000000000000000009999037009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"
    });

    return(
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1"),
        signedMessage: abi.encode(0x7def1d6D28D6bDa49E69fa89aD75d160BEcBa3AE),
        proofs: response.proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000200000000000000000000000007def1d6d28d6bda49e69fa89ad75d160becba3ae0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000100100000000000000000000000000009999037000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c004a229a4e5c5d8cee7e3578af8e704062c5aa27df2cef1b2b160f70ed8f9dae52805649ea3434124a60e87f5f66c7be677ec386484814cfd1fecff41065c8fa10b5184f6d352683c28753040ca96e87a64613c1c139085bea9a45740fe46d7322805c20bd78b9a81b4329fe7e7c2fb68374f996903fdf79e72ca98b1aaf572ca292079ebcf188bc4d7f80bc5ef8931a63f251ca6be0dc21c1aaeeed310d0f46d07711636b38e8812e6871c2a0b488acba7853a575ed77dda01e33b1a7c847dc2299cfa02050ba9f1cb20a74bf96634628bfa3f36fc72641a848b82fd9d08696101513fabac96d1bf451207abc436507bf82fc32863a349706c0fda6155555a8a000000000000000000000000100100000000000000000000000000009999037009f60d972df499264335faccfc437669a97ea2b6c97a1a7ddf3f0105eda34b1d2ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    );
  }

  function getResponseWithGitHubAuthWithoutSignature(ICommitmentMapperRegistry commitmentMapperRegistry) external returns (SismoConnectResponse memory response, bytes memory responseAsBytes) {
    // update EdDSA public key for proof made in dev.beta environment
    commitmentMapperRegistry.updateCommitmentMapperEdDSAPubKey(getEdDSAPubKeyDevBeta());

    Auth memory auth = AuthBuilder.build({authType: AuthType.GITHUB});

    SismoConnectProof[] memory proofs = new SismoConnectProof[](1);
    proofs[0] = ProofBuilder.build({
      auth: auth,
      proofData: hex"03f8d1e80e4f3063aa284b8a5b6ed6e6ec4ebd2664380529ff779c7e1122591d20fc7fb441842cb10cef074dfda8ebf2150e6a251cd8ed26fbb796eb5f5bbc3425c04e528b004923670361d0a9c7f836ed78de8f40740c9d5462afbc9c0f5b5a0ffa301c342d1eb7f3c1a1b3d022b2f094af52746a14810a13e3484743b916202a92688d4d21234c1e0b4d2b5ee7345265efa28631316d3c55fb73882c7d5cec1fdf75249e3ffe0db07dc6cafd69f0e9ebb67f6a7b6896af6cc8e83facfa92f92b3e096f9e7396b28f1fbf899c786c08abb295cbd6104d896ed0a053e0400d1e2b3f895df69562ca8e7030d1a2a05ff64d56b09d56f19cb9d9c6e932aad1b8a9000000000000000000000000100100000000000000000000000000009999037000000000000000000000000000000000000000000000000000000000000000002ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"
    });

    return(
      SismoConnectResponse({
        appId: 0x11b1de449c6c4adb0b5775b3868b28b3,
        namespace: bytes16(keccak256("main")),
        version: bytes32("sismo-connect-v1"),
        signedMessage: "",
        proofs: response.proofs
      }),
      // response as bytes
      hex"000000000000000000000000000000000000000000000000000000000000002011b1de449c6c4adb0b5775b3868b28b300000000000000000000000000000000b8e2054f8a912367e38a22ce773328ff000000000000000000000000000000007369736d6f2d636f6e6e6563742d76310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001a068796472612d73322e310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000004a000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000100100000000000000000000000000009999037000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c003f8d1e80e4f3063aa284b8a5b6ed6e6ec4ebd2664380529ff779c7e1122591d20fc7fb441842cb10cef074dfda8ebf2150e6a251cd8ed26fbb796eb5f5bbc3425c04e528b004923670361d0a9c7f836ed78de8f40740c9d5462afbc9c0f5b5a0ffa301c342d1eb7f3c1a1b3d022b2f094af52746a14810a13e3484743b916202a92688d4d21234c1e0b4d2b5ee7345265efa28631316d3c55fb73882c7d5cec1fdf75249e3ffe0db07dc6cafd69f0e9ebb67f6a7b6896af6cc8e83facfa92f92b3e096f9e7396b28f1fbf899c786c08abb295cbd6104d896ed0a053e0400d1e2b3f895df69562ca8e7030d1a2a05ff64d56b09d56f19cb9d9c6e932aad1b8a9000000000000000000000000100100000000000000000000000000009999037000000000000000000000000000000000000000000000000000000000000000002ab71fb864979b71106135acfa84afc1d756cda74f8f258896f896b4864f025630423b4c502f1cd4179a425723bf1e15c843733af2ecdee9aef6a0451ef2db7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018202c14c40a8bc84b8fc8748836190f53fc45c66ad969c7bfa2a91afdd1ad8d01935d4d418952220ae0332606f61de2894d8b84c3076e6097ef3746a1ba04a5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000"
    );
  }
}
